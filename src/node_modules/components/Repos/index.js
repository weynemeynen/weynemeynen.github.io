import React, { useContext } from 'react'
import classNames from 'classnames'
import { Link } from 'react-router-dom'

import { ThemeContext, DARK } from 'contexts'
import { formatDate } from 'utils'

import 'components/Repos/repos.css'

export default function Repos({ repos }) {
  const [theme,] = useContext(ThemeContext)

  const textColorLink = theme === DARK ? 'info' : 'primary'
  const borderColor = theme === DARK ? 'border-secondary' : ''

  const renameRepo = (name) => name === 'misc' ? 'разное' : name

  const repositories = repos.map((repo) => {
    const languageClass = classNames({
      'info': repo.language === 'Vue',
      'warning': repo.language === 'JavaScript',
      'danger': repo.language === 'HTML',
    })

    return (
      <div className="col px-sm-0" key={repo.name}>
        <div className={`card border border-top-0 border-start-0 border-end-0 rounded-0 bg-transparent ${borderColor}`} key={repo.id}>
          <div className="row g-0">
            <div className="col-sm-12">
              <div className="card-body d-flex py-4 px-0">
                <div className='col flex-grow-1'>
                  <Link to={`/repositories/${repo.name}`} className={`card-title fs-5 fw-bold text-decoration-none text-${textColorLink}`}>{renameRepo(repo.name)}</Link>
                  <small className="card-text d-block my-2">{repo.description}</small>
                  <small className="card-text d-flex d-inline-flex align-items-center">
                    <small className='d-inline-flex align-items-center'>
                      <span className={`repos-language rounded-circle d-inline-block me-1 bg-${languageClass}`}></span>
                      <span className='me-3'>{repo.language}</span>
                    </small>
                    <small>
                      <span className='me-1'>обновлено</span>
                      <span>{formatDate(repo.updated_at)}</span>
                    </small>
                  </small>
                </div>
                <div className='col d-flex align-items-center flex-grow-0'>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    )
  })

  return <div className="repos row row-cols-1 row-cols-xl-2 row-cols-xxl-3">
    {repositories}
  </div>
}