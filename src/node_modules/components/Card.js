import React, { useContext, useEffect, useState } from 'react'

import axios from 'axios';

import { ThemeContext } from 'contexts'

export default function Card() {
  const [data, setData] = useState({ hits: [] })
  const [query, setQuery] = useState('weynemeynen')

  console.log(data.name)

  useEffect(() => {
    let ignore = false

    async function fetchData() {
      const result = await axios('https://api.github.com/users/' + query)
      if (!ignore) setData(result.data)
    }

    fetchData()
    return () => { ignore = true }
  }, [query])

  const [theme,] = useContext(ThemeContext)

  let textColor = theme === 'dark' ? 'light' : 'dark'

  return (
    <div className={`card container px-lg-5 border-0 bg-${theme} text-${textColor}`}>
      <div className="row g-0 mx-lg-5 px-lg-5">
        <div className="col-sm-4 col-md-2" style={{ marginTop: '-1.5em' }} itemScope itemType="http://schema.org/Person">
          <div className="row">
            <div className="col-3 col-sm-12">
              <img src={data.avatar_url} className="img-fluid rounded-circle mb-4" alt={data.name} />
            </div>
            <div className="col-9 col-sm-12">
              <h1>
                <div itemProp="name" className='fs-4 '>{data.name}</div>
                <div itemProp="additionalName" className={`fs-6 fw-light text-${textColor}`}>{data.login}</div>
              </h1>
              <ul className={`list-unstyled text-${textColor}`}>
                <li>
                  <i className="bi bi-building d-inline-block text-center" style={{ width: '20px' }}></i>
                  <small>{data.company}</small>
                </li>
                <li>
                  <i className="bi bi-geo-alt d-inline-block text-center" style={{ width: '20px' }}></i>
                  <small>{data.location}</small>
                </li>
                <li className="text-truncate">
                  <i className="bi bi-link-45deg d-inline-block text-center" style={{ width: '20px' }}></i>
                  <a href="#" className="text-decoration-none text-reset"><small>{data.blog}</small></a>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div className="col-sm-8 col-md-10">
          <div className='card-header'>
            <input value={query} onChange={e => setQuery(e.target.value)} />
          </div>
          <div className="card-body">
            <h5 className="card-title">{data.login}</h5>
            <p className="card-text">This is a wider card with supporting text below as a natural lead-in to additional content. This content is a little bit longer.</p>
            <p className="card-text"><small className="text-muted">Last updated 3 mins ago</small></p>
          </div>
        </div>
      </div>
    </div>
  )
}