import React, { useEffect, useContext, useState } from 'react'
import classNames from "classnames";
import { NavLink } from 'react-router-dom';

import { ThemeContext, LIGHT, DARK } from 'contexts'

import './navbar.css'

import { routesMap } from 'routes'

export default function Navbar() {
  const [theme, setTheme] = useContext(ThemeContext)
  const [show, setShow] = useState(false)

  useEffect(() => {
    document.body.className = `bg-${theme}`
  }, [theme])

  const switchTheme = () => setTheme(prev => prev === DARK ? LIGHT : DARK)
  const switchShow = () => setShow(prevShow => !prevShow)

  const isShow = show ? 'show' : ''

  const iconClasses = classNames({
    'bi-moon-stars': theme === LIGHT,
    'bi-sun': theme === DARK
  })

  const active = classNames({
    [`text-${LIGHT}`]: () => theme === LIGHT ? LIGHT : LIGHT,
  })

  return (
    <nav className={`bg-${DARK} navbar navbar-${DARK} navbar-expand-sm py-2 sticky-top`}>
      <div className="container py-1">
        <button className="navbar-toggler border-0 ps-0 position-relative" type="button" onClick={switchShow}>
          <span className="navbar-toggler-icon"></span>
        </button>
        <div className={`collapse navbar-collapse order-1 order-sm-0 row ${isShow}`}>
          <div className="backdrop position-fixed top-0 start-0 end-0 bottom-0" data-type="backdrop" onClick={switchShow}></div>
          <nav className="navbar-nav px-3 position-relative">
            <NavLink to={routesMap.home} exact className="nav-link border-bottom border-secondary" activeClassName={active} onClick={switchShow}>Портфолио</NavLink>
          </nav>
        </div>
        <div className={`btn-group col-2 justify-content-end text-${LIGHT}`} role="group">
          <i className={`${iconClasses}`}
            role='button'
            onClick={switchTheme}
            title='переключить цвет.тему'></i>
        </div>
      </div>
    </nav>
  )
}